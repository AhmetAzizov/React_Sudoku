let s=[],p=[];onmessage=d=>{let c=d.data;const m=Array(c).fill(0).map((r,a)=>a+1);_(),D(),postMessage([s,p]);function u(){return m.sort(()=>Math.random()-.5).slice()}function n(r,a){return r*c+a}function g(r,a,f,t){for(var e=0;e<c;e++)if(e!=a&&r[n(e,f)]==t||e!=f&&r[n(a,e)]==t)return!1;for(var l=Math.floor(a/3),i=Math.floor(f/3),o=0;o<3;o++)for(var v=l*3+o,h=0;h<3;h++){var M=i*3+h;if(!(v==a&&M==f)&&r[n(v,M)]==t)return!1}return!0}function D(){let a,f;for(var t=0;t<c;t++){f=[0,1,2,3,4,5,6,7,8];for(var e=1;e<6;e++)a=Math.floor(Math.random()*f.length),s[n(t,f[a])]=null,f.splice(a,1);f.forEach(l=>{p.push(n(t,l))})}}function _(){var r=0;let a,f=Date.now();for(var t=0;t<c;t++)for(var e=u(),l=0,i=0;i<9;i++){var o=Math.floor(Math.random()*e.length),v=e[o];if(g(s,t,i,v)?(s[n(t,i)]=v,e.splice(o,1)):(l++,i--),a=Date.now()-f,a>300){f=Date.now(),t=-1,l=0,r=0,s=[];break}if(l>40&&(s.splice(n(t,0)),i=-1,l=0,e=u(),r++),r>50){s.splice(n(t-1,0)),t--,t>-1&&t--;break}}s.slice()}};
