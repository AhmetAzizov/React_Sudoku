(function(){"use strict";function l(t,n,r){return t*r+n}function M(t,n,r,o,a){for(var e=0;e<a;e++)if(e!=n&&t[l(e,r,a)]==o||e!=r&&t[l(n,e,a)]==o)return!1;for(var f=Math.floor(n/(a/3)),u=Math.floor(r/3),s=0;s<a/3;s++)for(var i=f*(a/3)+s,d=0;d<3;d++){var h=u*3+d;if(!(i==n&&h==r)&&t[l(i,h,a)]==o)return!1}return!0}function g(t){return t.sort(()=>Math.random()-.5)}let c=[];const p=[];self.onmessage=t=>{const[n,r]=t.data;y({format:n,difficulty:r}),v({format:n,difficulty:r}),self.postMessage([c,p])};function v({format:t,difficulty:n}){let r,o;for(let a=0;a<t;a++){o=Array(t).fill(0).map((e,f)=>f);for(let e=1;e<n;e++)r=Math.floor(Math.random()*o.length),c[l(a,o[r],t)]=null,o.splice(r,1);o.forEach(e=>{p.push(l(a,e,t))})}}function y({format:t}){let n=0;const r=Date.now();let o=Array(t).fill(0).map((e,f)=>f+1);for(let e=0;e<t;e++){const f=Date.now();let u=0;const s=g(o);o=s.slice();for(let i=0;i<t;i++){const d=Math.floor(Math.random()*s.length),h=s[d];if(M(c,e,i,h,t)?(c[l(e,i,t)]=h,s.splice(d,1)):(u++,i--),Date.now()-f>70){e=-1,n=0,c=[];break}if(u>30){c.splice(l(e,0,t)),e--,u=0,++n>40&&(c.splice(l(e-1,0,t)),n=0,e>-1&&e--);break}}}const a=Date.now();console.log(`game generated in ${a-r} ms`)}})();
